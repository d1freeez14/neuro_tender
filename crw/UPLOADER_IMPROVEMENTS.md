# Улучшения модуля uploader.py

## Основные изменения

### 1. Безопасность
- **Учетные данные**: Пароль и логин теперь читаются из переменных окружения
- **Валидация данных**: Добавлена проверка всех входных параметров
- **Безопасные настройки**: Увеличен timeout и добавлен retry механизм

### 2. Архитектура
- **Класс DocumentUploader**: Основная логика вынесена в класс
- **Конфигурация**: Создан класс UploadConfig для управления настройками
- **Типизация**: Добавлены type hints для всех функций и методов

### 3. Обработка ошибок
- **Retry механизм**: Автоматические повторы при временных сбоях
- **Специфичные исключения**: Разные типы ошибок обрабатываются отдельно
- **Детальное логирование**: Подробные логи для отладки

### 4. Логирование
- **Структурированные логи**: Использование logger вместо print
- **Уровни логирования**: DEBUG, INFO, ERROR для разных ситуаций
- **Контекстная информация**: Логи содержат ID тендеров и другую полезную информацию

### 5. Валидация
- **Проверка БИН**: Валидация формата БИН (12 цифр)
- **Проверка MD5**: Валидация длины MD5 хеша
- **Проверка файлов**: Проверка наличия и корректности файлов

## Переменные окружения

Для безопасной работы создайте файл `.env` в корне проекта:

```bash
DOCUMENTOLOG_USERNAME=documentolog
DOCUMENTOLOG_PASSWORD=your_password_here
DOCUMENTOLOG_URL=https://portal.documentolog.kz/webservice/json/create_tented
DOCUMENTOLOG_TIMEOUT=30
DOCUMENTOLOG_MAX_RETRIES=3
DOCUMENTOLOG_BACKOFF_FACTOR=0.3
```

## Использование

### Базовое использование (обратная совместимость)
```python
from uploader import upload, executor

# Старый способ (все еще работает)
result = upload(company_name, bin, message, file, md5sum, kratkij_ii_analiz_ts)
```

### Новый способ с классом
```python
from uploader import DocumentUploader, UploadConfig

# Создание конфигурации
config = UploadConfig(
    timeout=60,
    max_retries=5
)

# Создание загрузчика
uploader = DocumentUploader(config)

# Загрузка документа
document_id = uploader.upload(company_name, bin, message, file, md5sum, kratkij_ii_analiz_ts)
```

## Преимущества улучшений

1. **Надежность**: Retry механизм и лучшая обработка ошибок
2. **Безопасность**: Учетные данные в переменных окружения
3. **Масштабируемость**: Классовая архитектура для легкого расширения
4. **Отладка**: Подробные логи для диагностики проблем
5. **Валидация**: Предотвращение ошибок на раннем этапе
6. **Типизация**: Лучшая поддержка IDE и статический анализ
